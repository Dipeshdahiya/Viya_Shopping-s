{"ast":null,"code":"import axios from 'axios';\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000/api';\n\n// Function to get CSRF token from cookies\nconst getCsrfToken = () => {\n  const name = 'csrftoken';\n  const cookies = document.cookie.split(';');\n  for (let cookie of cookies) {\n    const [key, value] = cookie.trim().split('=');\n    if (key === name) {\n      return value;\n    }\n  }\n  return null;\n};\nconst api = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  withCredentials: true\n});\n\n// Request interceptor - Add CSRF token and handle session authentication\napi.interceptors.request.use(config => {\n  // Add CSRF token to all requests\n  const csrfToken = getCsrfToken();\n  if (csrfToken) {\n    config.headers['X-CSRFToken'] = csrfToken;\n  }\n  // Session authentication is handled automatically via withCredentials\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Response interceptor\napi.interceptors.response.use(response => response, error => {\n  var _error$response;\n  if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n    // Don't redirect to login automatically - let components handle it\n    // This prevents auto-redirect after logout\n    // Only redirect if we're on a protected page\n    const protectedPaths = ['/profile', '/orders', '/checkout'];\n    const currentPath = window.location.pathname;\n    if (protectedPaths.some(path => currentPath.startsWith(path))) {\n      window.location.href = '/login';\n    }\n  }\n  return Promise.reject(error);\n});\nexport default api;","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","getCsrfToken","name","cookies","document","cookie","split","key","value","trim","api","create","baseURL","headers","withCredentials","interceptors","request","use","config","csrfToken","error","Promise","reject","response","_error$response","status","protectedPaths","currentPath","window","location","pathname","some","path","startsWith","href"],"sources":["C:/Users/HP/OneDrive/Desktop/ecommmer/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000/api';\n\n// Function to get CSRF token from cookies\nconst getCsrfToken = () => {\n  const name = 'csrftoken';\n  const cookies = document.cookie.split(';');\n  for (let cookie of cookies) {\n    const [key, value] = cookie.trim().split('=');\n    if (key === name) {\n      return value;\n    }\n  }\n  return null;\n};\n\nconst api = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  withCredentials: true,\n});\n\n// Request interceptor - Add CSRF token and handle session authentication\napi.interceptors.request.use(\n  (config) => {\n    // Add CSRF token to all requests\n    const csrfToken = getCsrfToken();\n    if (csrfToken) {\n      config.headers['X-CSRFToken'] = csrfToken;\n    }\n    // Session authentication is handled automatically via withCredentials\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// Response interceptor\napi.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response?.status === 401) {\n      // Don't redirect to login automatically - let components handle it\n      // This prevents auto-redirect after logout\n      // Only redirect if we're on a protected page\n      const protectedPaths = ['/profile', '/orders', '/checkout'];\n      const currentPath = window.location.pathname;\n      if (protectedPaths.some(path => currentPath.startsWith(path))) {\n        window.location.href = '/login';\n      }\n    }\n    return Promise.reject(error);\n  }\n);\n\nexport default api;\n\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,YAAY,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,2BAA2B;;AAEjF;AACA,MAAMC,YAAY,GAAGA,CAAA,KAAM;EACzB,MAAMC,IAAI,GAAG,WAAW;EACxB,MAAMC,OAAO,GAAGC,QAAQ,CAACC,MAAM,CAACC,KAAK,CAAC,GAAG,CAAC;EAC1C,KAAK,IAAID,MAAM,IAAIF,OAAO,EAAE;IAC1B,MAAM,CAACI,GAAG,EAAEC,KAAK,CAAC,GAAGH,MAAM,CAACI,IAAI,CAAC,CAAC,CAACH,KAAK,CAAC,GAAG,CAAC;IAC7C,IAAIC,GAAG,KAAKL,IAAI,EAAE;MAChB,OAAOM,KAAK;IACd;EACF;EACA,OAAO,IAAI;AACb,CAAC;AAED,MAAME,GAAG,GAAGd,KAAK,CAACe,MAAM,CAAC;EACvBC,OAAO,EAAEf,YAAY;EACrBgB,OAAO,EAAE;IACP,cAAc,EAAE;EAClB,CAAC;EACDC,eAAe,EAAE;AACnB,CAAC,CAAC;;AAEF;AACAJ,GAAG,CAACK,YAAY,CAACC,OAAO,CAACC,GAAG,CACzBC,MAAM,IAAK;EACV;EACA,MAAMC,SAAS,GAAGlB,YAAY,CAAC,CAAC;EAChC,IAAIkB,SAAS,EAAE;IACbD,MAAM,CAACL,OAAO,CAAC,aAAa,CAAC,GAAGM,SAAS;EAC3C;EACA;EACA,OAAOD,MAAM;AACf,CAAC,EACAE,KAAK,IAAK;EACT,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;;AAED;AACAV,GAAG,CAACK,YAAY,CAACQ,QAAQ,CAACN,GAAG,CAC1BM,QAAQ,IAAKA,QAAQ,EACrBH,KAAK,IAAK;EAAA,IAAAI,eAAA;EACT,IAAI,EAAAA,eAAA,GAAAJ,KAAK,CAACG,QAAQ,cAAAC,eAAA,uBAAdA,eAAA,CAAgBC,MAAM,MAAK,GAAG,EAAE;IAClC;IACA;IACA;IACA,MAAMC,cAAc,GAAG,CAAC,UAAU,EAAE,SAAS,EAAE,WAAW,CAAC;IAC3D,MAAMC,WAAW,GAAGC,MAAM,CAACC,QAAQ,CAACC,QAAQ;IAC5C,IAAIJ,cAAc,CAACK,IAAI,CAACC,IAAI,IAAIL,WAAW,CAACM,UAAU,CAACD,IAAI,CAAC,CAAC,EAAE;MAC7DJ,MAAM,CAACC,QAAQ,CAACK,IAAI,GAAG,QAAQ;IACjC;EACF;EACA,OAAOb,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;AAED,eAAeV,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}