{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP\\\\OneDrive\\\\Desktop\\\\ecommmer\\\\frontend\\\\src\\\\context\\\\CartContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport api from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CartContext = /*#__PURE__*/createContext();\nexport const useCart = () => {\n  _s();\n  const context = useContext(CartContext);\n  if (!context) {\n    throw new Error('useCart must be used within a CartProvider');\n  }\n  return context;\n};\n_s(useCart, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const CartProvider = ({\n  children\n}) => {\n  _s2();\n  const [cartItems, setCartItems] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const fetchCart = async () => {\n    try {\n      setLoading(true);\n      const response = await api.get('/cart/');\n      // Handle both paginated and direct array responses\n      const cartData = Array.isArray(response.data.results) ? response.data.results : Array.isArray(response.data) ? response.data : [];\n      setCartItems(cartData);\n    } catch (error) {\n      var _error$response;\n      // If user is not authenticated, cart will be empty\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) !== 401) {\n        console.error('Error fetching cart:', error);\n      }\n      setCartItems([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    fetchCart();\n  }, []);\n  const addToCart = async (productId, quantity = 1) => {\n    try {\n      await api.post('/cart/', {\n        product_id: productId,\n        quantity: quantity\n      });\n      await fetchCart();\n    } catch (error) {\n      console.error('Error adding to cart:', error);\n      throw error;\n    }\n  };\n  const updateCartItem = async (cartItemId, quantity) => {\n    try {\n      await api.patch(`/cart/${cartItemId}/`, {\n        quantity\n      });\n      await fetchCart();\n    } catch (error) {\n      console.error('Error updating cart:', error);\n      throw error;\n    }\n  };\n  const removeFromCart = async cartItemId => {\n    try {\n      await api.delete(`/cart/${cartItemId}/`);\n      await fetchCart();\n    } catch (error) {\n      console.error('Error removing from cart:', error);\n      throw error;\n    }\n  };\n  const getCartTotal = () => {\n    if (!Array.isArray(cartItems)) return 0;\n    return cartItems.reduce((total, item) => total + (item.total_price || 0), 0);\n  };\n  const getCartCount = () => {\n    if (!Array.isArray(cartItems)) return 0;\n    return cartItems.reduce((count, item) => count + (item.quantity || 0), 0);\n  };\n  const value = {\n    cartItems,\n    loading,\n    addToCart,\n    updateCartItem,\n    removeFromCart,\n    getCartTotal,\n    getCartCount,\n    fetchCart\n  };\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 10\n  }, this);\n};\n_s2(CartProvider, \"hjcORomU9r2JakrDaeOjXnDhWgs=\");\n_c = CartProvider;\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","api","jsxDEV","_jsxDEV","CartContext","useCart","_s","context","Error","CartProvider","children","_s2","cartItems","setCartItems","loading","setLoading","fetchCart","response","get","cartData","Array","isArray","data","results","error","_error$response","status","console","addToCart","productId","quantity","post","product_id","updateCartItem","cartItemId","patch","removeFromCart","delete","getCartTotal","reduce","total","item","total_price","getCartCount","count","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/HP/OneDrive/Desktop/ecommmer/frontend/src/context/CartContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport api from '../services/api';\n\nconst CartContext = createContext();\n\nexport const useCart = () => {\n  const context = useContext(CartContext);\n  if (!context) {\n    throw new Error('useCart must be used within a CartProvider');\n  }\n  return context;\n};\n\nexport const CartProvider = ({ children }) => {\n  const [cartItems, setCartItems] = useState([]);\n  const [loading, setLoading] = useState(false);\n\n  const fetchCart = async () => {\n    try {\n      setLoading(true);\n      const response = await api.get('/cart/');\n      // Handle both paginated and direct array responses\n      const cartData = Array.isArray(response.data.results) \n        ? response.data.results \n        : (Array.isArray(response.data) ? response.data : []);\n      setCartItems(cartData);\n    } catch (error) {\n      // If user is not authenticated, cart will be empty\n      if (error.response?.status !== 401) {\n        console.error('Error fetching cart:', error);\n      }\n      setCartItems([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchCart();\n  }, []);\n\n  const addToCart = async (productId, quantity = 1) => {\n    try {\n      await api.post('/cart/', {\n        product_id: productId,\n        quantity: quantity,\n      });\n      await fetchCart();\n    } catch (error) {\n      console.error('Error adding to cart:', error);\n      throw error;\n    }\n  };\n\n  const updateCartItem = async (cartItemId, quantity) => {\n    try {\n      await api.patch(`/cart/${cartItemId}/`, { quantity });\n      await fetchCart();\n    } catch (error) {\n      console.error('Error updating cart:', error);\n      throw error;\n    }\n  };\n\n  const removeFromCart = async (cartItemId) => {\n    try {\n      await api.delete(`/cart/${cartItemId}/`);\n      await fetchCart();\n    } catch (error) {\n      console.error('Error removing from cart:', error);\n      throw error;\n    }\n  };\n\n  const getCartTotal = () => {\n    if (!Array.isArray(cartItems)) return 0;\n    return cartItems.reduce((total, item) => total + (item.total_price || 0), 0);\n  };\n\n  const getCartCount = () => {\n    if (!Array.isArray(cartItems)) return 0;\n    return cartItems.reduce((count, item) => count + (item.quantity || 0), 0);\n  };\n\n  const value = {\n    cartItems,\n    loading,\n    addToCart,\n    updateCartItem,\n    removeFromCart,\n    getCartTotal,\n    getCartCount,\n    fetchCart,\n  };\n\n  return <CartContext.Provider value={value}>{children}</CartContext.Provider>;\n};\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}